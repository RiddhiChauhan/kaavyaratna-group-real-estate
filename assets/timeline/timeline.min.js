"use strict";
var _slicedToArray = function(e, t) {
    if (Array.isArray(e)) return e;
    if (Symbol.iterator in Object(e)) return function(e, t) {
        var i = [],
            n = !0,
            l = !1,
            r = void 0;
        try {
            for (var a, s = e[Symbol.iterator](); !(n = (a = s.next()).done) && (i.push(a.value), !t || i.length !== t); n = !0);
        } catch (e) {
            l = !0, r = e
        } finally {
            try {
                !n && s.return && s.return()
            } finally {
                if (l) throw r
            }
        }
        return i
    }(e, t);
    throw new TypeError("Invalid attempt to destructure non-iterable instance")
};

function timeline(e, t) {
    var i = [],
        n = "Timeline:",
        l = window.innerWidth,
        r = void 0,
        a = 0,
        s = {
            forceVerticalMode: {
                type: "integer",
                defaultValue: 600
            },
            horizontalStartPosition: {
                type: "string",
                acceptedValues: ["bottom", "top"],
                defaultValue: "top"
            },
            mode: {
                type: "string",
                acceptedValues: ["horizontal", "vertical"],
                defaultValue: "vertical"
            },
            moveItems: {
                type: "integer",
                defaultValue: 1
            },
            startIndex: {
                type: "integer",
                defaultValue: 0
            },
            verticalStartPosition: {
                type: "string",
                acceptedValues: ["left", "right"],
                defaultValue: "left"
            },
            verticalTrigger: {
                type: "string",
                defaultValue: "15%"
            },
            visibleItems: {
                type: "integer",
                defaultValue: 3
            }
        };

    function o(e, t, i) {
        t.classList.add(i), e.parentNode.insertBefore(t, e), t.appendChild(e)
    }

    function d(e, t) {
        var i = e.getBoundingClientRect(),
            n = window.innerHeight || document.documentElement.clientHeight,
            l = s.verticalTrigger.defaultValue.match(/(\d*\.?\d*)(.*)/),
            r = t.unit,
            a = t.value,
            o = n;
        if ("px" === r && n <= a) {
            console.warn('The value entered for the setting "verticalTrigger" is larger than the window height. The default value will be used instead.');
            var d = _slicedToArray(l, 3);
            a = d[1], r = d[2]
        }
        return "px" === r ? o = parseInt(o - a, 10) : "%" === r && (o = parseInt(o * ((100 - a) / 100), 10)), i.top <= o && i.left <= (window.innerWidth || document.documentElement.clientWidth) && 0 <= i.top + i.height && 0 <= i.left + i.width
    }

    function c(e, t) {
        e.style.webkitTransform = t, e.style.msTransform = t, e.style.transform = t
    }

    function m(e) {
        var t = "translate3d(-" + e.items[a].offsetLeft + "px, 0, 0)";
        c(e.scroller, t)
    }

    function u() {
        i.forEach(function(e) {
            e.timelineEl.style.opacity = 0, e.timelineEl.classList.contains("timeline--loaded") || e.items.forEach(function(e) {
                    o(e.querySelector(".timeline__content"), document.createElement("div"), "timeline__content__wrap"), o(e.querySelector(".timeline__content__wrap"), document.createElement("div"), "timeline__item__inner")
                }),
                function(e) {
                    e.timelineEl.classList.remove("timeline--horizontal", "timeline--mobile"), e.scroller.removeAttribute("style"), e.items.forEach(function(e) {
                        e.removeAttribute("style"), e.classList.remove("animated", "fadeIn", "timeline__item--left", "timeline__item--right")
                    });
                    var t = e.timelineEl.querySelectorAll(".timeline-nav-button");
                    [].forEach.call(t, function(e) {
                        e.parentNode.removeChild(e)
                    })
                }(e), window.innerWidth <= e.settings.forceVerticalMode && e.timelineEl.classList.add("timeline--mobile"), "horizontal" === e.settings.mode && window.innerWidth > e.settings.forceVerticalMode ? function(e) {
                    var t, i, n, l, r, s, o;
                    a = e.settings.startIndex, e.timelineEl.classList.add("timeline--horizontal"), t = e, window.innerWidth > t.settings.forceVerticalMode && (t.itemWidth = t.wrap.offsetWidth / t.settings.visibleItems, t.items.forEach(function(e) {
                            e.style.width = t.itemWidth + "px"
                        }), t.scrollerWidth = t.itemWidth * t.items.length, t.scroller.style.width = t.scrollerWidth + "px", function() {
                            var e = 0,
                                i = 0;
                            t.items.forEach(function(t, n) {
                                t.style.height = "auto";
                                var l = t.offsetHeight;
                                n % 2 == 0 ? i = i < l ? l : i : e = e < l ? l : e
                            });
                            var n = "translateY(" + i + "px)";
                            t.items.forEach(function(l, r) {
                                r % 2 == 0 ? (l.style.height = i + "px", "bottom" === t.settings.horizontalStartPosition ? (l.classList.add("timeline__item--bottom"), c(l, n)) : l.classList.add("timeline__item--top")) : (l.style.height = e + "px", "bottom" !== t.settings.horizontalStartPosition ? (l.classList.add("timeline__item--bottom"), c(l, n)) : l.classList.add("timeline__item--top"))
                            }), t.scroller.style.height = i + e + "px"
                        }()), m(e),
                        function(e) {
                            if (e.items.length > e.settings.visibleItems) {
                                var t = document.createElement("button"),
                                    i = document.createElement("button"),
                                    n = e.items[0].offsetHeight;
                                t.className = "timeline-nav-button timeline-nav-button--prev", i.className = "timeline-nav-button timeline-nav-button--next", t.textContent = "Previous", i.textContent = "Next", t.style.top = n + "px", i.style.top = n + "px", 0 === a ? t.disabled = !0 : a === e.items.length - e.settings.visibleItems && (i.disabled = !0), e.timelineEl.appendChild(t), e.timelineEl.appendChild(i)
                            }
                        }(e),
                        function(e) {
                            var t = e.timelineEl.querySelector(".timeline-divider");
                            t && e.timelineEl.removeChild(t);
                            var i = e.items[0].offsetHeight,
                                n = document.createElement("span");
                            n.className = "timeline-divider", n.style.top = i + "px", e.timelineEl.appendChild(n)
                        }(e), n = (i = e).timelineEl.querySelectorAll(".timeline-nav-button"), l = i.timelineEl.querySelector(".timeline-nav-button--prev"), r = i.timelineEl.querySelector(".timeline-nav-button--next"), s = i.items.length - i.settings.visibleItems, o = parseInt(i.settings.moveItems, 10), [].forEach.call(n, function(e) {
                            e.addEventListener("click", function(e) {
                                e.preventDefault(), 0 === (a = this.classList.contains("timeline-nav-button--next") ? a += o : a -= o) || a < 0 ? (a = 0, l.disabled = !0, r.disabled = !1) : a === s || s < a ? (a = s, l.disabled = !1, r.disabled = !0) : (l.disabled = !1, r.disabled = !1), m(i)
                            })
                        })
                }(e) : function(e) {
                    var t = 0;
                    e.items.forEach(function(i, n) {
                        i.classList.remove("animated", "fadeIn"), !d(i, e.settings.verticalTrigger) && 0 < n ? i.classList.add("animated") : t = n, n % 2 == ("left" === e.settings.verticalStartPosition ? 1 : 0) && window.innerWidth > e.settings.forceVerticalMode ? i.classList.add("timeline__item--right") : i.classList.add("timeline__item--left")
                    });
                    for (var i = 0; i < t; i += 1) e.items[i].classList.remove("animated", "fadeIn");
                    window.addEventListener("scroll", function() {
                        e.items.forEach(function(t) {
                            d(t, e.settings.verticalTrigger) && t.classList.add("fadeIn")
                        })
                    })
                }(e), e.timelineEl.classList.add("timeline--loaded"), setTimeout(function() {
                    e.timelineEl.style.opacity = 1
                }, 500)
        })
    }
    e.length && [].forEach.call(e, function(e) {
        var l = e.id ? "#" + e.id : "." + e.className,
            r = "could not be found as a direct descendant of",
            a = e.dataset,
            o = void 0,
            d = void 0,
            c = void 0,
            m = {};
        try {
            if (!(o = e.querySelector(".timeline__wrap"))) throw new Error(n + " .timeline__wrap " + r + " " + l);
            if (!(d = o.querySelector(".timeline__items"))) throw new Error(n + " .timeline__items " + r + " .timeline__wrap");
            c = [].slice.call(d.children, 0)
        } catch (e) {
            return console.warn(e.message), !1
        }
        Object.keys(s).forEach(function(e) {
            var i, l;
            m[e] = s[e].defaultValue, a[e] ? m[e] = a[e] : t && t[e] && (m[e] = t[e]), "integer" === s[e].type ? m[e] && (l = e, "number" == typeof(i = m[e]) || i % 1 == 0 || (console.warn(n + ' The value "' + i + '" entered for the setting "' + l + '" is not an integer.'), 0)) || (m[e] = s[e].defaultValue) : "string" === s[e].type && s[e].acceptedValues && -1 === s[e].acceptedValues.indexOf(m[e]) && (console.warn(n + ' The value "' + m[e] + '" entered for the setting "' + e + '" was not recognised.'), m[e] = s[e].defaultValue)
        });
        var u = s.verticalTrigger.defaultValue.match(/(\d*\.?\d*)(.*)/),
            f = m.verticalTrigger.match(/(\d*\.?\d*)(.*)/),
            h = _slicedToArray(f, 3),
            v = h[1],
            g = h[2],
            p = !0;
        if (v || (console.warn(n + " No numercial value entered for the 'verticalTrigger' setting."), p = !1), "px" !== g && "%" !== g && (console.warn(n + " The setting 'verticalTrigger' must be a percentage or pixel value."), p = !1), "%" === g && (100 < v || v < 0) ? (console.warn(n + " The 'verticalTrigger' setting value must be between 0 and 100 if using a percentage value."), p = !1) : "px" === g && v < 0 && (console.warn(n + " The 'verticalTrigger' setting value must be above 0 if using a pixel value."), p = !1), !1 === p) {
            var b = _slicedToArray(u, 3);
            v = b[1], g = b[2]
        }
        m.verticalTrigger = {
            unit: g,
            value: v
        }, m.moveItems > m.visibleItems && (console.warn(n + ' The value of "moveItems" (' + m.moveItems + ') is larger than the number of "visibleItems" (' + m.visibleItems + '). The value of "visibleItems" has been used instead.'), m.moveItems = m.visibleItems), m.startIndex >= c.length - m.visibleItems ? (console.warn(n + " The 'startIndex' setting must be between 0 and " + (c.length - m.visibleItems) + " for this timeline. The value of " + (c.length - m.visibleItems) + " has been used instead."), m.startIndex = c.length - m.visibleItems) : m.startIndex < 0 && (console.warn(n + " The 'startIndex' setting must be between 0 and " + (c.length - m.visibleItems) + " for this timeline. The value of 0 has been used instead."), m.startIndex = 0), i.push({
            timelineEl: e,
            wrap: o,
            scroller: d,
            items: c,
            settings: m
        })
    }), u(), window.addEventListener("resize", function() {
        clearTimeout(r), r = setTimeout(function() {
            var e = window.innerWidth;
            e !== l && (u(), l = e)
        }, 250)
    })
}
window.jQuery && (window.jQuery.fn.timeline = function(e) {
    return timeline(this, e), this
}), window.jQuery, timeline(document.querySelectorAll(".timeline"), {
    forceVerticalMode: 700,
    mode: "horizontal",
    verticalStartPosition: "left",
    visibleItems: 5
});